<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>–†—É–ª–µ—Ç–∫–∞ –ü—Ä–µ–º–∏—É–º–∞ 2.0</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      --success-gradient: linear-gradient(135deg, #00d2ff 0%, #3a7bd5 100%);
      --danger-gradient: linear-gradient(135deg, #ff416c 0%, #ff4b2b 100%);
      --warning-gradient: linear-gradient(135deg, #f7971e 0%, #ffd200 100%);
      --dark-bg: #0f0c29;
      --darker-bg: #09071d;
      --card-bg: rgba(20, 18, 50, 0.9);
      --border-color: rgba(120, 119, 198, 0.3);
      --text-primary: #f0f0ff;
      --text-secondary: #b0b0ff;
      --accent-purple: #8a2be2;
      --accent-blue: #4169e1;
      --accent-pink: #ff1493;
      --shadow-glow: 0 0 40px rgba(102, 126, 234, 0.15);
      --transition-smooth: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.1);
    }

    body {
      font-family: 'Segoe UI', 'Inter', system-ui, sans-serif;
      background: var(--dark-bg);
      background: linear-gradient(135deg, var(--dark-bg) 0%, var(--darker-bg) 100%);
      color: var(--text-primary);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 15px;
      overflow-x: hidden;
    }

    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background:
        radial-gradient(circle at 20% 30%, rgba(102, 126, 234, 0.1) 0%, transparent 50%),
        radial-gradient(circle at 80% 70%, rgba(255, 20, 147, 0.08) 0%, transparent 50%),
        radial-gradient(circle at 40% 80%, rgba(65, 105, 225, 0.05) 0%, transparent 50%);
      z-index: -1;
    }

    .container {
      width: 100%;
      max-width: 1000px;
      background: var(--card-bg);
      border-radius: 24px;
      border: 1px solid var(--border-color);
      box-shadow: var(--shadow-glow), 0 25px 50px -12px rgba(0, 0, 0, 0.5);
      overflow: hidden;
      backdrop-filter: blur(12px);
      animation: containerAppear 0.8s ease-out;
    }

    @keyframes containerAppear {
      from {
        opacity: 0;
        transform: translateY(30px) scale(0.95);
      }
      to {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }

    .header {
      background: linear-gradient(90deg, #4a36a8, #6a4acd, #8a5eff);
      padding: 24px 32px;
      text-align: center;
      position: relative;
      overflow: hidden;
    }

    .header::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: linear-gradient(45deg, transparent 30%, rgba(255,255,255,0.1) 50%, transparent 70%);
      animation: shimmer 8s infinite linear;
      z-index: 1;
    }

    @keyframes shimmer {
      0% { transform: translateX(-50%) translateY(-50%) rotate(0deg); }
      100% { transform: translateX(-50%) translateY(-50%) rotate(360deg); }
    }

    .header-content {
      position: relative;
      z-index: 2;
    }

    .header h1 {
      font-size: 2.2rem;
      font-weight: 800;
      letter-spacing: 2px;
      background: linear-gradient(to right, #fff 0%, #ffd700 100%);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      text-shadow: 0 4px 20px rgba(255, 215, 0, 0.3);
      margin-bottom: 8px;
    }

    .header p {
      font-size: 1rem;
      color: rgba(255, 255, 255, 0.8);
      font-weight: 300;
    }

    .main-content {
      display: flex;
      flex-direction: column;
      gap: 32px;
      padding: 32px;
    }

    @media (min-width: 992px) {
      .main-content {
        flex-direction: row;
        align-items: stretch;
        gap: 40px;
      }
    }

    .left-panel, .right-panel {
      flex: 1;
      min-width: 0;
    }

    .left-panel {
      background: rgba(15, 13, 40, 0.7);
      border-radius: 20px;
      padding: 28px;
      border: 1px solid rgba(120, 119, 198, 0.2);
      box-shadow: inset 0 4px 20px rgba(0, 0, 0, 0.2);
      position: relative;
      overflow: hidden;
    }

    .left-panel::after {
      content: '';
      position: absolute;
      bottom: 0;
      right: 0;
      width: 150px;
      height: 150px;
      background: radial-gradient(circle, rgba(102, 126, 234, 0.1) 0%, transparent 70%);
      z-index: 0;
    }

    .panel-content {
      position: relative;
      z-index: 1;
    }

    .balance-display {
      background: linear-gradient(135deg, rgba(30, 28, 65, 0.8), rgba(20, 18, 50, 0.9));
      border-radius: 16px;
      padding: 20px 24px;
      margin-bottom: 28px;
      border: 1px solid rgba(255, 215, 0, 0.3);
      box-shadow: 0 8px 32px rgba(255, 215, 0, 0.1);
      display: flex;
      justify-content: space-between;
      align-items: center;
      transition: var(--transition-smooth);
    }

    .balance-display:hover {
      transform: translateY(-4px);
      box-shadow: 0 12px 40px rgba(255, 215, 0, 0.2);
    }

    .balance-label {
      color: var(--text-secondary);
      font-size: 1.1rem;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .balance-label i {
      color: #ffd700;
      font-size: 1.3rem;
    }

    .balance-value {
      color: #ffd700;
      font-weight: 800;
      font-size: 2rem;
      display: flex;
      align-items: center;
      gap: 8px;
      text-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
    }

    .control-group {
      margin-bottom: 28px;
      background: rgba(25, 23, 55, 0.6);
      padding: 20px;
      border-radius: 16px;
      border: 1px solid rgba(120, 119, 198, 0.1);
      transition: var(--transition-smooth);
    }

    .control-group:hover {
      border-color: rgba(120, 119, 198, 0.3);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
    }

    .control-group label {
      display: block;
      margin-bottom: 12px;
      font-size: 1rem;
      color: var(--text-secondary);
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .control-group label i {
      color: var(--accent-purple);
      font-size: 1.1rem;
    }

    input[type="range"] {
      width: 100%;
      height: 12px;
      border-radius: 10px;
      background: linear-gradient(to right, #4a36a8 0%, #8a5eff 100%);
      outline: none;
      -webkit-appearance: none;
      margin-bottom: 12px;
      transition: var(--transition-smooth);
      box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.3);
    }

    input[type="range"]:hover {
      height: 14px;
    }

    input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 28px;
      height: 28px;
      border-radius: 50%;
      background: white;
      border: 4px solid #8a5eff;
      box-shadow: 0 0 20px rgba(138, 94, 255, 0.8), 0 4px 12px rgba(0, 0, 0, 0.3);
      cursor: pointer;
      transition: var(--transition-smooth);
    }

    input[type="range"]::-webkit-slider-thumb:hover {
      transform: scale(1.2);
      box-shadow: 0 0 30px rgba(138, 94, 255, 1);
    }

    .value-display {
      text-align: center;
      font-size: 1.8rem;
      font-weight: 700;
      margin-top: 12px;
      min-height: 2.2em;
      padding: 12px;
      border-radius: 12px;
      background: rgba(30, 28, 65, 0.5);
      border: 1px solid rgba(120, 119, 198, 0.2);
      transition: var(--transition-smooth);
    }

    .value-display:hover {
      transform: scale(1.02);
      border-color: rgba(120, 119, 198, 0.4);
    }

    .value-display.stars {
      color: #ffd700;
      text-shadow: 0 0 15px rgba(255, 215, 0, 0.5);
    }

    .value-display.days {
      color: #00d2ff;
      text-shadow: 0 0 15px rgba(0, 210, 255, 0.5);
    }

    .range-container {
      display: flex;
      align-items: center;
      gap: 16px;
      margin-bottom: 12px;
    }

    .range-label {
      font-size: 0.9rem;
      color: var(--text-secondary);
      min-width: 50px;
      font-weight: 500;
    }

    .range-label.min {
      text-align: left;
    }

    .range-label.max {
      text-align: right;
    }

    .range-wrapper {
      flex: 1;
    }

    /* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —Ä—É–ª–µ—Ç–∫–∏ */
    .roulette-container {
      position: relative;
      width: 320px;
      height: 320px;
      margin: 0 auto 40px;
    }

    @media (max-width: 768px) {
      .roulette-container {
        width: 280px;
        height: 280px;
      }
    }

    .chance-circle {
      position: absolute;
      width: 100%;
      height: 100%;
      background: radial-gradient(circle at 50% 50%, #1a1740 0%, #0f0c29 80%);
      border-radius: 50%;
      border: 12px solid rgba(102, 126, 234, 0.3);
      box-shadow:
        inset 0 0 60px rgba(0, 0, 0, 0.7),
        0 0 80px rgba(102, 126, 234, 0.4),
        0 20px 60px rgba(0, 0, 0, 0.5);
      overflow: hidden;
      animation: pulse 4s infinite ease-in-out;
    }

    @keyframes pulse {
      0%, 100% { box-shadow: inset 0 0 60px rgba(0, 0, 0, 0.7), 0 0 80px rgba(102, 126, 234, 0.4); }
      50% { box-shadow: inset 0 0 60px rgba(0, 0, 0, 0.7), 0 0 100px rgba(102, 126, 234, 0.6); }
    }

    .progress-ring {
      position: absolute;
      inset: 0;
      border-radius: 50%;
      background: conic-gradient(
        #00ffaa 0deg var(--success-deg),
        #ff4477 var(--success-deg) 360deg
      );
      -webkit-mask: radial-gradient(farthest-side, transparent calc(50% - 16px), black calc(50% - 14px));
      mask: radial-gradient(farthest-side, transparent calc(50% - 16px), black calc(50% - 14px));
      filter: drop-shadow(0 0 20px currentColor);
    }

    /* –í—Ä–∞—â–∞—é—â–∞—è—Å—è —Å—Ç—Ä–µ–ª–∫–∞-—Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫ */
    .spin-arrow {
      position: absolute;
      top: -20px;
      left: 50%;
      width: 40px;
      height: 80px;
      transform: translateX(-50%) rotate(0deg);
      transform-origin: center 180px;
      z-index: 20;
      filter: drop-shadow(0 0 15px rgba(255, 51, 102, 0.8));
    }

    .arrow-triangle {
      position: absolute;
      width: 0;
      height: 0;
      border-left: 20px solid transparent;
      border-right: 20px solid transparent;
      border-top: 60px solid #ff3366;
      top: 0;
      left: 0;
      border-radius: 8px 8px 0 0;
    }

    .arrow-glow {
      position: absolute;
      width: 60px;
      height: 60px;
      background: radial-gradient(circle, rgba(255, 51, 102, 0.6), transparent 80%);
      border-radius: 50%;
      top: -10px;
      left: -10px;
      animation: pulseGlow 2s infinite;
    }

    @keyframes pulseGlow {
      0%, 100% { opacity: 0.7; }
      50% { opacity: 1; }
    }

    /* –¢–µ–∫—Å—Ç –≤ —Ü–µ–Ω—Ç—Ä–µ */
    .center-text {
      position: absolute;
      inset: 0;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      padding: 30px;
      z-index: 5;
    }

    .chance-value {
      font-size: 4rem;
      font-weight: 900;
      color: #fff;
      text-shadow: 0 0 30px currentColor;
      line-height: 1;
      margin-bottom: 10px;
      background: linear-gradient(to right, #00d2ff, #8a5eff);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      animation: textShine 3s infinite linear;
    }

    @keyframes textShine {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    .chance-desc {
      font-size: 1.1rem;
      color: var(--text-secondary);
      margin-top: 8px;
      letter-spacing: 1px;
      font-weight: 300;
    }

    .spin-button {
      width: 100%;
      padding: 22px;
      font-size: 1.5rem;
      font-weight: 800;
      background: linear-gradient(135deg, #ff6b6b 0%, #ff8e53 100%);
      color: white;
      border: none;
      border-radius: 16px;
      cursor: pointer;
      box-shadow: 0 12px 40px rgba(255, 107, 107, 0.4);
      transition: var(--transition-smooth);
      text-transform: uppercase;
      letter-spacing: 2px;
      margin-top: 10px;
      position: relative;
      overflow: hidden;
    }

    .spin-button::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
      transition: left 0.7s;
    }

    .spin-button:hover {
      transform: translateY(-6px) scale(1.02);
      box-shadow: 0 20px 50px rgba(255, 107, 107, 0.6);
    }

    .spin-button:hover::before {
      left: 100%;
    }

    .topup-button {
      width: 100%;
      padding: 18px;
      font-size: 1.2rem;
      font-weight: 700;
      background: linear-gradient(135deg, #4a9eff 0%, #2a6eff 100%);
      color: white;
      border: none;
      border-radius: 14px;
      cursor: pointer;
      box-shadow: 0 8px 30px rgba(74, 158, 255, 0.3);
      transition: var(--transition-smooth);
      margin-top: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
    }

    .topup-button:hover {
      transform: translateY(-4px);
      box-shadow: 0 15px 40px rgba(74, 158, 255, 0.5);
    }

    .admin-button {
      width: 100%;
      padding: 18px;
      font-size: 1.2rem;
      font-weight: 700;
      background: linear-gradient(135deg, #ff4d94 0%, #ff2a7a 100%);
      color: white;
      border: none;
      border-radius: 14px;
      cursor: pointer;
      box-shadow: 0 8px 30px rgba(255, 77, 148, 0.3);
      transition: var(--transition-smooth);
      margin-top: 15px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
    }

    .admin-button:hover {
      transform: translateY(-4px);
      box-shadow: 0 15px 40px rgba(255, 77, 148, 0.5);
    }

    .result {
      margin-top: 32px;
      font-size: 1.8rem;
      font-weight: 700;
      text-align: center;
      min-height: 2.5em;
      padding: 20px;
      border-radius: 16px;
      background: rgba(30, 28, 65, 0.7);
      border: 2px solid transparent;
      transition: var(--transition-smooth);
    }

    .win {
      color: #00ffaa;
      text-shadow: 0 0 25px #00ffaa;
      border-color: rgba(0, 255, 170, 0.3);
      background: linear-gradient(135deg, rgba(0, 255, 170, 0.1), rgba(30, 28, 65, 0.7));
      animation: winPulse 2s infinite;
    }

    @keyframes winPulse {
      0%, 100% { box-shadow: 0 0 20px rgba(0, 255, 170, 0.3); }
      50% { box-shadow: 0 0 40px rgba(0, 255, 170, 0.6); }
    }

    .lose {
      color: #ff5555;
      text-shadow: 0 0 20px #ff5555;
      border-color: rgba(255, 85, 85, 0.3);
    }

    .small-hint {
      text-align: center;
      font-size: 0.9rem;
      color: #a0a0ff;
      margin-top: 16px;
      padding: 12px;
      background: rgba(40, 38, 75, 0.5);
      border-radius: 10px;
      border-left: 4px solid var(--accent-purple);
    }

    /* –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –Ω–∞ –∫—Ä—É–≥–µ */
    .circle-marks {
      position: absolute;
      inset: 0;
      z-index: 2;
    }

    .mark {
      position: absolute;
      width: 3px;
      height: 20px;
      background: rgba(255, 255, 255, 0.2);
      top: 0;
      left: 50%;
      transform-origin: center 160px;
      transition: var(--transition-smooth);
    }

    .mark.highlight {
      background: rgba(255, 255, 255, 0.5);
      height: 28px;
      width: 4px;
    }

    .topup-options {
      display: none;
      flex-direction: column;
      gap: 12px;
      margin-top: 20px;
      background: rgba(25, 23, 55, 0.8);
      padding: 20px;
      border-radius: 16px;
      border: 1px solid rgba(120, 119, 198, 0.3);
      box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
      animation: slideDown 0.5s ease-out;
    }

    @keyframes slideDown {
      from {
        opacity: 0;
        transform: translateY(-20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .topup-option {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 16px 20px;
      background: rgba(40, 38, 75, 0.6);
      border-radius: 12px;
      border: 2px solid rgba(74, 158, 255, 0.2);
      cursor: pointer;
      transition: var(--transition-smooth);
    }

    .topup-option:hover {
      background: rgba(50, 48, 95, 0.8);
      border-color: rgba(74, 158, 255, 0.5);
      transform: translateY(-4px);
    }

    .topup-option.selected {
      background: rgba(60, 58, 115, 0.9);
      border-color: #4a9eff;
      box-shadow: 0 0 25px rgba(74, 158, 255, 0.4);
    }

    .topup-amount {
      font-weight: 700;
      color: #ffd700;
      font-size: 1.3rem;
    }

    .topup-price {
      color: var(--text-secondary);
      font-size: 0.95rem;
    }

    .topup-confirm-button {
      width: 100%;
      padding: 18px;
      font-size: 1.2rem;
      font-weight: 700;
      background: linear-gradient(135deg, #00cc66 0%, #00aa44 100%);
      color: white;
      border: none;
      border-radius: 14px;
      cursor: pointer;
      box-shadow: 0 8px 30px rgba(0, 204, 102, 0.3);
      transition: var(--transition-smooth);
      margin-top: 15px;
    }

    .topup-confirm-button:hover {
      transform: translateY(-4px);
      box-shadow: 0 15px 40px rgba(0, 204, 102, 0.5);
    }

    .payment-info {
      text-align: center;
      color: #4a9eff;
      margin-top: 15px;
      font-size: 0.9rem;
      padding: 15px;
      background: rgba(74, 158, 255, 0.1);
      border-radius: 12px;
      border: 1px solid rgba(74, 158, 255, 0.3);
    }

    /* –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å */
    .admin-panel {
      display: none;
      flex-direction: column;
      gap: 12px;
      margin-top: 20px;
      background: rgba(40, 20, 60, 0.9);
      padding: 20px;
      border-radius: 16px;
      border: 1px solid rgba(138, 43, 226, 0.5);
      box-shadow: 0 15px 40px rgba(138, 43, 226, 0.2);
      animation: slideDown 0.5s ease-out;
    }

    .admin-section-title {
      text-align: center;
      font-size: 1.3rem;
      font-weight: 700;
      color: #ff80ff;
      margin-bottom: 10px;
      padding-bottom: 12px;
      border-bottom: 2px solid rgba(138, 43, 226, 0.5);
      text-shadow: 0 0 15px rgba(255, 128, 255, 0.5);
    }

    .admin-input-group {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .admin-input-group label {
      font-size: 0.95rem;
      color: #c0c0ff;
      font-weight: 500;
    }

    .admin-input {
      padding: 12px 16px;
      background: rgba(30, 20, 50, 0.8);
      border: 2px solid rgba(138, 43, 226, 0.3);
      border-radius: 10px;
      color: white;
      font-size: 1rem;
      transition: var(--transition-smooth);
    }

    .admin-input:focus {
      outline: none;
      border-color: #8a2be2;
      box-shadow: 0 0 20px rgba(138, 43, 226, 0.4);
    }

    .admin-buttons {
      display: flex;
      gap: 12px;
      margin-top: 15px;
    }

    .admin-btn {
      flex: 1;
      padding: 14px;
      font-size: 1rem;
      font-weight: 600;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      transition: var(--transition-smooth);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }

    .admin-btn:hover {
      transform: translateY(-4px);
    }

    .admin-users-list {
      max-height: 250px;
      overflow-y: auto;
      background: rgba(30, 20, 50, 0.8);
      border-radius: 12px;
      border: 1px solid rgba(138, 43, 226, 0.3);
      padding: 15px;
      margin-top: 15px;
    }

    /* –ü–æ–ª–æ—Å–∞ –ø—Ä–æ–∫—Ä—É—Ç–∫–∏ */
    .admin-users-list::-webkit-scrollbar {
      width: 8px;
    }

    .admin-users-list::-webkit-scrollbar-track {
      background: rgba(30, 20, 50, 0.5);
      border-radius: 4px;
    }

    .admin-users-list::-webkit-scrollbar-thumb {
      background: rgba(138, 43, 226, 0.6);
      border-radius: 4px;
    }

    .admin-user-item {
      padding: 12px;
      border-bottom: 1px solid rgba(138, 43, 226, 0.2);
      cursor: pointer;
      transition: var(--transition-smooth);
      border-radius: 8px;
      margin-bottom: 8px;
    }

    .admin-user-item:hover {
      background: rgba(138, 43, 226, 0.2);
      transform: translateX(5px);
    }

    .admin-stats {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 15px;
      margin-top: 15px;
    }

    .stat-item {
      background: rgba(30, 20, 50, 0.8);
      padding: 15px;
      border-radius: 12px;
      text-align: center;
      border: 1px solid rgba(138, 43, 226, 0.3);
      transition: var(--transition-smooth);
    }

    .stat-item:hover {
      transform: translateY(-5px);
      border-color: rgba(138, 43, 226, 0.6);
    }

    .stat-value {
      font-size: 1.5rem;
      font-weight: 800;
      color: #ffd700;
      margin-top: 8px;
    }

    /* –ü–ª–∞–≤–∞—é—â–∞—è –∫–Ω–æ–ø–∫–∞ –∞–¥–º–∏–Ω–∞ */
    .admin-float-btn {
      position: fixed;
      bottom: 30px;
      right: 30px;
      width: 60px;
      height: 60px;
      background: linear-gradient(135deg, #ff4d94, #ff2a7a);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 1.8rem;
      cursor: pointer;
      box-shadow: 0 8px 25px rgba(255, 77, 148, 0.4);
      z-index: 1000;
      transition: var(--transition-smooth);
      border: 3px solid rgba(255, 255, 255, 0.2);
    }

    .admin-float-btn:hover {
      transform: scale(1.15) rotate(15deg);
      box-shadow: 0 12px 35px rgba(255, 77, 148, 0.6);
    }

    /* –ê–Ω–∏–º–∞—Ü–∏–∏ –¥–ª—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ */
    @keyframes float {
      0%, 100% { transform: translateY(0px); }
      50% { transform: translateY(-10px); }
    }

    .balance-display, .roulette-container {
      animation: float 6s ease-in-out infinite;
    }

    /* –ú–µ–¥–∏–∞-–∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç–∏ */
    @media (max-width: 768px) {
      .container {
        border-radius: 20px;
      }

      .header {
        padding: 20px;
      }

      .header h1 {
        font-size: 1.8rem;
      }

      .main-content {
        padding: 20px;
        gap: 20px;
      }

      .left-panel {
        padding: 20px;
      }

      .balance-value {
        font-size: 1.7rem;
      }

      .chance-value {
        font-size: 3rem;
      }

      .spin-button {
        padding: 18px;
        font-size: 1.3rem;
      }

      .admin-buttons {
        flex-direction: column;
      }
    }

    /* –ù–µ–æ–Ω–æ–≤—ã–π —ç—Ñ—Ñ–µ–∫—Ç –¥–ª—è –≤–∞–∂–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ */
    .glow-effect {
      position: relative;
    }

    .glow-effect::after {
      content: '';
      position: absolute;
      top: -2px;
      left: -2px;
      right: -2px;
      bottom: -2px;
      border-radius: inherit;
      background: inherit;
      filter: blur(15px);
      opacity: 0.7;
      z-index: -1;
    }

    /* –ê–Ω–∏–º–∞—Ü–∏—è –¥–ª—è –∫–Ω–æ–ø–æ–∫ */
    .button-pulse {
      animation: buttonPulse 2s infinite;
    }

    @keyframes buttonPulse {
      0%, 100% { box-shadow: 0 0 20px rgba(255, 107, 107, 0.4); }
      50% { box-shadow: 0 0 40px rgba(255, 107, 107, 0.8); }
    }
  </style>
</head>
<body>

<div class="container">
  <div class="header">
    <div class="header-content">
      <h1>üé∞ –†–£–õ–ï–¢–ö–ê –ü–†–ï–ú–ò–£–ú–ê 2.0</h1>
      <p>–ò—Å–ø—ã—Ç–∞–π—Ç–µ —É–¥–∞—á—É –∏ –≤—ã–∏–≥—Ä–∞–π—Ç–µ –¥–Ω–∏ –ø—Ä–µ–º–∏—É–º–∞!</p>
    </div>
  </div>

  <div class="main-content">
    <!-- –õ–µ–≤–∞—è –ø–∞–Ω–µ–ª—å ‚Äî –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ -->
    <div class="left-panel">
      <div class="panel-content">
        <div class="balance-display glow-effect">
          <div class="balance-label">
            <i class="fas fa-wallet"></i>
            –í–∞—à –±–∞–ª–∞–Ω—Å:
          </div>
          <div class="balance-value" id="balance-value">
            <i class="fas fa-star"></i>
            <span id="balance">0</span> ‚≠ê
          </div>
        </div>

        <div class="control-group">
          <label>
            <i class="fas fa-star"></i>
            –°—Ç–∞–≤–∫–∞ (Telegram Stars):
          </label>
          <div class="range-container">
            <span class="range-label min">9 ‚≠ê</span>
            <div class="range-wrapper">
              <input type="range" id="stars" min="9" max="999" value="199" step="1"/>
            </div>
            <span class="range-label max">999 ‚≠ê</span>
          </div>
          <div class="value-display stars">
            <span id="stars-value">199</span> ‚≠ê
          </div>
        </div>

        <div class="control-group">
          <label>
            <i class="fas fa-calendar-alt"></i>
            –ñ–µ–ª–∞–µ–º–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–Ω–µ–π –ø—Ä–µ–º–∏—É–º–∞:
          </label>
          <div class="range-container">
            <span class="range-label min">1 –¥</span>
            <div class="range-wrapper">
              <input type="range" id="days" min="1" max="365" value="30" step="1"/>
            </div>
            <span class="range-label max">365 –¥</span>
          </div>
          <div class="value-display days">
            <span id="days-value">30</span> –¥–Ω–µ–π
          </div>
        </div>

        <button class="spin-button button-pulse" id="spin-btn">
          <i class="fas fa-play-circle"></i>
          –ü–†–û–ö–†–£–¢–ò–¢–¨ –†–£–õ–ï–¢–ö–£
        </button>

        <button class="topup-button" id="topup-btn">
          <i class="fas fa-coins"></i>
          –ü–û–ü–û–õ–ù–ò–¢–¨ –ë–ê–õ–ê–ù–°
        </button>

        <div class="small-hint">
          <i class="fas fa-lightbulb"></i>
          –ß–µ–º –±–æ–ª—å—à–µ —Å—Ç–∞–≤–∫–∞ ‚Äî —Ç–µ–º –≤—ã—à–µ —à–∞–Ω—Å –≤—ã–∏–≥—Ä–∞—Ç—å –∂–µ–ª–∞–µ–º–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–Ω–µ–π
        </div>

        <!-- –°–∫—Ä—ã—Ç–∞—è –ø–∞–Ω–µ–ª—å –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è -->
        <div class="topup-options" id="topup-options">
          <div class="small-hint" style="margin-bottom: 15px;">
            <i class="fas fa-shopping-cart"></i>
            –í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–≤–µ–∑–¥ –¥–ª—è –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è:
          </div>

          <div class="topup-option" data-amount="49">
            <div>
              <div class="topup-amount">49 ‚≠ê</div>
              <div class="topup-price">–ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ</div>
            </div>
            <i class="fas fa-check" style="color: #00ff88; display: none;"></i>
          </div>

          <div class="topup-option" data-amount="99">
            <div>
              <div class="topup-amount">99 ‚≠ê</div>
              <div class="topup-price">–ü–æ–ø—É–ª—è—Ä–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç</div>
            </div>
            <i class="fas fa-check" style="color: #00ff88; display: none;"></i>
          </div>

          <div class="topup-option" data-amount="199">
            <div>
              <div class="topup-amount">199 ‚≠ê</div>
              <div class="topup-price">–í—ã–≥–æ–¥–Ω–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ</div>
            </div>
            <i class="fas fa-check" style="color: #00ff88; display: none;"></i>
          </div>

          <div class="topup-option" data-amount="499">
            <div>
              <div class="topup-amount">499 ‚≠ê</div>
              <div class="topup-price">–î–ª—è –∞–∫—Ç–∏–≤–Ω—ã—Ö –∏–≥—Ä–æ–∫–æ–≤</div>
            </div>
            <i class="fas fa-check" style="color: #00ff88; display: none;"></i>
          </div>

          <div class="topup-option" data-amount="999">
            <div>
              <div class="topup-amount">999 ‚≠ê</div>
              <div class="topup-price">–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ</div>
            </div>
            <i class="fas fa-check" style="color: #00ff88; display: none;"></i>
          </div>

          <button class="topup-confirm-button" id="topup-confirm-btn" disabled>
            <i class="fas fa-shopping-cart"></i>
            –í–´–ë–†–ê–¢–¨ –î–õ–Ø –ü–û–ü–û–õ–ù–ï–ù–ò–Ø
          </button>

          <div class="payment-info">
            <i class="fas fa-info-circle"></i>
            –û–ø–ª–∞—Ç–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è —á–µ—Ä–µ–∑ Telegram Stars. –ü–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –æ–∫–Ω–æ –æ–ø–ª–∞—Ç—ã.
          </div>

          <div class="small-hint" style="margin-top: 15px;">
            <i class="fas fa-exclamation-circle"></i>
            –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è: 49 ‚≠ê
          </div>
        </div>

        <!-- –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å (—Å–∫—Ä—ã—Ç–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) -->
        <div class="admin-panel" id="admin-panel">
          <div class="admin-section-title">
            <i class="fas fa-crown"></i> –ü–ê–ù–ï–õ–¨ –ê–î–ú–ò–ù–ò–°–¢–†–ê–¢–û–†–ê
          </div>

          <div class="admin-input-group">
            <label for="admin-user-id">ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:</label>
            <input type="text" id="admin-user-id" class="admin-input" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 123456789">
          </div>

          <div class="admin-input-group">
            <label for="admin-stars-amount">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–≤–µ–∑–¥:</label>
            <input type="number" id="admin-stars-amount" class="admin-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ" min="1" max="999999" value="1000">
          </div>

          <div class="admin-buttons">
            <button class="admin-btn add" id="admin-add-btn">
              <i class="fas fa-plus-circle"></i> –î–æ–±–∞–≤–∏—Ç—å
            </button>
            <button class="admin-btn remove" id="admin-remove-btn">
              <i class="fas fa-minus-circle"></i> –°–Ω—è—Ç—å
            </button>
            <button class="admin-btn set" id="admin-set-btn">
              <i class="fas fa-equals"></i> –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
            </button>
          </div>

          <div class="admin-stats">
            <div class="stat-item">
              <div class="stat-label">–í—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>
              <div class="stat-value" id="total-users">0</div>
            </div>
            <div class="stat-item">
              <div class="stat-label">–û–±—â–∏–π –±–∞–ª–∞–Ω—Å</div>
              <div class="stat-value" id="total-balance">0 ‚≠ê</div>
            </div>
          </div>

          <div class="admin-input-group">
            <label for="admin-search-user">–ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:</label>
            <input type="text" id="admin-search-user" class="admin-input" placeholder="ID, –∏–º—è –∏–ª–∏ username">
          </div>

          <div class="admin-users-list" id="admin-users-list">
            <!-- –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±—É–¥–µ—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            <div class="admin-user-item" data-user-id="123456789">
              <div class="user-info">
                <div class="user-name">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</div>
                <div class="user-balance">‚àû ‚≠ê</div>
              </div>
            </div>
          </div>

          <div class="admin-warning">
            <i class="fas fa-exclamation-triangle"></i>
            –¢–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤! –í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –ª–æ–≥–∏—Ä—É—é—Ç—Å—è.
          </div>
        </div>

        <!-- –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–µ –±–∞–ª–∞–Ω—Å–∞ -->
        <div id="no-balance-warning" class="no-balance-warning" style="display: none;">
          <i class="fas fa-exclamation-triangle"></i>
          –£ –≤–∞—Å –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∑–≤–µ–∑–¥ –¥–ª—è —Å—Ç–∞–≤–∫–∏. –ü–æ–ø–æ–ª–Ω–∏—Ç–µ –±–∞–ª–∞–Ω—Å.
        </div>
      </div>
    </div>

    <!-- –ü—Ä–∞–≤–∞—è –ø–∞–Ω–µ–ª—å ‚Äî —Ä—É–ª–µ—Ç–∫–∞ -->
    <div class="right-panel">
      <div class="roulette-container">
        <!-- –í—Ä–∞—â–∞—é—â–∞—è—Å—è —Å—Ç—Ä–µ–ª–∫–∞-—Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫ -->
        <div class="spin-arrow" id="spin-arrow">
          <div class="arrow-glow"></div>
          <div class="arrow-triangle"></div>
        </div>

        <!-- –ö—Ä—É–≥ —Å —Ä–∞–∑–º–µ—Ç–∫–æ–π -->
        <div class="circle-marks" id="circle-marks"></div>

        <!-- –ö—Ä—É–≥ —Ä—É–ª–µ—Ç–∫–∏ -->
        <div class="chance-circle" id="roulette">
          <div class="progress-ring" id="progress"></div>
          <div class="center-text">
            <div class="chance-value" id="chance-value">‚Äî</div>
            <div class="chance-desc">–®–ê–ù–° –ù–ê –ü–û–ë–ï–î–£</div>
          </div>
        </div>
      </div>

      <div class="result" id="result"></div>
    </div>
  </div>
</div>

<!-- –ü–ª–∞–≤–∞—é—â–∞—è –∫–Ω–æ–ø–∫–∞ –∞–¥–º–∏–Ω–∞ (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤) -->
<div class="admin-float-btn" id="admin-float-btn" style="display: none;">
  <i class="fas fa-crown"></i>
</div>

<script src="https://telegram.org/js/telegram-web-app.js"></script>
<script>
// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Web App
const tg = window.Telegram.WebApp;
tg.ready();
tg.expand();

// –ü–æ–ª—É—á–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã DOM
const starsSlider = document.getElementById('stars');
const starsDisplay = document.getElementById('stars-value');
const daysSlider = document.getElementById('days');
const daysDisplay = document.getElementById('days-value');
const chanceValue = document.getElementById('chance-value');
const progressRing = document.getElementById('progress');
const spinBtn = document.getElementById('spin-btn');
const resultDiv = document.getElementById('result');
const spinArrow = document.getElementById('spin-arrow');
const circleMarks = document.getElementById('circle-marks');
const balanceValue = document.getElementById('balance');
const topupBtn = document.getElementById('topup-btn');
const topupOptions = document.getElementById('topup-options');
const topupConfirmBtn = document.getElementById('topup-confirm-btn');
const topupOptionElements = document.querySelectorAll('.topup-option');
const noBalanceWarning = document.getElementById('no-balance-warning');
const adminPanel = document.getElementById('admin-panel');
const adminFloatBtn = document.getElementById('admin-float-btn');
const adminUserIdInput = document.getElementById('admin-user-id');
const adminStarsAmountInput = document.getElementById('admin-stars-amount');
const adminAddBtn = document.getElementById('admin-add-btn');
const adminRemoveBtn = document.getElementById('admin-remove-btn');
const adminSetBtn = document.getElementById('admin-set-btn');
const adminSearchInput = document.getElementById('admin-search-user');
const adminUsersList = document.getElementById('admin-users-list');
const totalUsersElement = document.getElementById('total-users');
const totalBalanceElement = document.getElementById('total-balance');

let isSpinning = false;
let animationFrameId = null;
let currentBalance = 0;
let selectedTopupAmount = 0;

// –°–ø–∏—Å–æ–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ (–¥–æ–±–∞–≤—å—Ç–µ —Å—é–¥–∞ ID –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤)
const ADMIN_IDS = [
  123456789, // –ü—Ä–∏–º–µ—Ä ID –∞–¥–º–∏–Ω–∞
  // –î–æ–±–∞–≤—å—Ç–µ —Å—é–¥–∞ —Ä–µ–∞–ª—å–Ω—ã–µ ID –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤
];

// –ü—Ä–æ–≤–µ—Ä–∫–∞, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —Ç–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º
function checkIfAdmin() {
  const user = tg.initDataUnsafe?.user;
  if (!user) return false;

  const userId = user.id;
  return ADMIN_IDS.includes(userId);
}

// –ü–æ–∫–∞–∑—ã–≤–∞–µ–º/—Å–∫—Ä—ã–≤–∞–µ–º –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø—Ä–∞–≤
function setupAdminPanel() {
  const isAdmin = checkIfAdmin();

  if (isAdmin) {
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–ª–∞–≤–∞—é—â—É—é –∫–Ω–æ–ø–∫—É –∞–¥–º–∏–Ω–∞
    adminFloatBtn.style.display = 'flex';

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –ø–æ –ø–ª–∞–≤–∞—é—â–µ–π –∫–Ω–æ–ø–∫–µ
    adminFloatBtn.addEventListener('click', () => {
      const isVisible = adminPanel.style.display === 'block';
      adminPanel.style.display = isVisible ? 'none' : 'block';
      adminFloatBtn.innerHTML = isVisible ? '<i class="fas fa-crown"></i>' : '<i class="fas fa-times"></i>';

      if (!isVisible) {
        // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
        loadAdminData();
      }
    });

    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º ID —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –ø–æ–ª–µ –≤–≤–æ–¥–∞
    if (tg.initDataUnsafe?.user?.id) {
      adminUserIdInput.value = tg.initDataUnsafe.user.id;
    }

    console.log('–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –¥–æ—Å—Ç—É–ø–Ω–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ID:', tg.initDataUnsafe?.user?.id);
  }
}

// –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
function loadAdminData() {
  // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—É–¥–µ—Ç –∑–∞–ø—Ä–æ—Å –∫ —Å–µ—Ä–≤–µ—Ä—É
  // –î–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º –º–æ–∫–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ

  // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
  updateAdminStats();

  // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
  loadUserList();
}

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
function updateAdminStats() {
  // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—É–¥–µ—Ç –∑–∞–ø—Ä–æ—Å –∫ API
  // –î–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º –º–æ–∫–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
  totalUsersElement.textContent = '127';
  totalBalanceElement.textContent = '45,280 ‚≠ê';
}

// –ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø–∏—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
function loadUserList(searchQuery = '') {
  // –û—á–∏—â–∞–µ–º —Å–ø–∏—Å–æ–∫
  adminUsersList.innerHTML = '';

  // –ú–æ–∫–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
  const mockUsers = [
    { id: 123456789, name: '–ê–¥–º–∏–Ω', username: 'admin', balance: 999999 },
    { id: 987654321, name: '–ò–≤–∞–Ω', username: 'ivan123', balance: 1250 },
    { id: 555555555, name: '–ú–∞—Ä–∏—è', username: 'maria_g', balance: 500 },
    { id: 444444444, name: '–ê–ª–µ–∫—Å–µ–π', username: 'alex_tech', balance: 75 },
    { id: 333333333, name: '–ï–∫–∞—Ç–µ—Ä–∏–Ω–∞', username: 'kate_s', balance: 3200 },
  ];

  // –§–∏–ª—å—Ç—Ä—É–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ –ø–æ–∏—Å–∫–æ–≤–æ–º—É –∑–∞–ø—Ä–æ—Å—É
  const filteredUsers = mockUsers.filter(user => {
    if (!searchQuery) return true;

    const query = searchQuery.toLowerCase();
    return (
      user.id.toString().includes(query) ||
      user.name.toLowerCase().includes(query) ||
      user.username.toLowerCase().includes(query)
    );
  });

  // –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ —Å–ø–∏—Å–æ–∫
  filteredUsers.forEach(user => {
    const userItem = document.createElement('div');
    userItem.className = 'admin-user-item';
    userItem.dataset.userId = user.id;

    userItem.innerHTML = `
      <div class="user-info">
        <div class="user-name">
          ${user.name} (@${user.username})
        </div>
        <div class="user-balance">
          ${user.balance.toLocaleString()} ‚≠ê
        </div>
      </div>
    `;

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
    userItem.addEventListener('click', () => {
      adminUserIdInput.value = user.id;
      adminStarsAmountInput.value = 1000;
    });

    adminUsersList.appendChild(userItem);
  });
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∞–¥–º–∏–Ω-–∫–æ–º–∞–Ω–¥—ã
function sendAdminCommand(action, userId, amount, reason = '') {
  const commandData = {
    action: 'admin_command',
    command: action,
    target_user_id: parseInt(userId),
    amount: parseInt(amount),
    reason: reason,
    admin_id: tg.initDataUnsafe?.user?.id,
    admin_name: tg.initDataUnsafe?.user?.first_name,
    admin_username: tg.initDataUnsafe?.user?.username,
    timestamp: new Date().toISOString()
  };

  // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∫–æ–º–∞–Ω–¥—É –±–æ—Ç—É
  tg.sendData(JSON.stringify(commandData));

  // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
  const actionText = action === 'add_stars' ? '–¥–æ–±–∞–≤–ª–µ–Ω—ã' :
                    action === 'remove_stars' ? '—Å–ø–∏—Å–∞–Ω—ã' : '—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã';

  tg.showAlert(`–ö–æ–º–∞–Ω–¥–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞! ${amount} –∑–≤–µ–∑–¥ –±—É–¥—É—Ç ${actionText} –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é ${userId}.`);

  // –ï—Å–ª–∏ –∫–æ–º–∞–Ω–¥–∞ –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –æ–±–Ω–æ–≤–ª—è–µ–º –ª–æ–∫–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å
  const currentUserId = tg.initDataUnsafe?.user?.id;
  if (parseInt(userId) === currentUserId) {
    if (action === 'add_stars') {
      currentBalance += parseInt(amount);
    } else if (action === 'remove_stars') {
      currentBalance = Math.max(0, currentBalance - parseInt(amount));
    } else if (action === 'set_stars') {
      currentBalance = parseInt(amount);
    }
    updateUI();
  }

  // –û–±–Ω–æ–≤–ª—è–µ–º –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
  loadAdminData();
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
setupAdminPanel();

// –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∞–¥–º–∏–Ω-–∫–Ω–æ–ø–æ–∫
adminAddBtn.addEventListener('click', () => {
  const userId = adminUserIdInput.value.trim();
  const amount = adminStarsAmountInput.value.trim();

  if (!userId || !amount) {
    tg.showAlert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è!');
    return;
  }

  sendAdminCommand('add_stars', userId, amount, '–†—É—á–Ω–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º');
});

adminRemoveBtn.addEventListener('click', () => {
  const userId = adminUserIdInput.value.trim();
  const amount = adminStarsAmountInput.value.trim();

  if (!userId || !amount) {
    tg.showAlert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è!');
    return;
  }

  sendAdminCommand('remove_stars', userId, amount, '–†—É—á–Ω–æ–µ —Å–ø–∏—Å–∞–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º');
});

adminSetBtn.addEventListener('click', () => {
  const userId = adminUserIdInput.value.trim();
  const amount = adminStarsAmountInput.value.trim();

  if (!userId || !amount) {
    tg.showAlert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è!');
    return;
  }

  sendAdminCommand('set_stars', userId, amount, '–†—É—á–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–∞–ª–∞–Ω—Å–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º');
});

// –ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
adminSearchInput.addEventListener('input', (e) => {
  loadUserList(e.target.value);
});

// –°–æ–∑–¥–∞–Ω–∏–µ —Ä–∞–∑–º–µ—Ç–∫–∏ –Ω–∞ –∫—Ä—É–≥–µ
function createCircleMarks() {
  const marksCount = 36;
  for (let i = 0; i < marksCount; i++) {
    const mark = document.createElement('div');
    mark.className = 'mark';
    if (i % 6 === 0) mark.classList.add('highlight');
    mark.style.transform = `rotate(${i * 10}deg)`;
    circleMarks.appendChild(mark);
  }
}

function calcChance() {
  const stars = Number(starsSlider.value);
  const days = Number(daysSlider.value) || 1;

  const basePrice = 18 + (days > 90 ? 4 : days > 30 ? 2 : 0);
  let chance = (stars / (days * basePrice)) * 100;

  chance = Math.max(3, Math.min(92, Math.round(chance * 10) / 10));

  return chance;
}

function updateUI() {
  const stars = starsSlider.value;
  starsDisplay.textContent = stars;

  const days = daysSlider.value;
  daysDisplay.textContent = days;

  const chance = calcChance();
  chanceValue.textContent = chance.toFixed(1) + "%";

  const deg = (chance / 100) * 360;
  progressRing.style.setProperty('--success-deg', deg + 'deg');

  chanceValue.style.color = chance > 65 ? '#00ffaa' :
                           chance > 35 ? '#ffdd55' : '#ff7777';

  // –û–±–Ω–æ–≤–ª—è–µ–º –±–∞–ª–∞–Ω—Å
  balanceValue.textContent = currentBalance.toLocaleString();

  // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ª–∏ –∑–≤–µ–∑–¥ –¥–ª—è —Å—Ç–∞–≤–∫–∏
  const betAmount = Number(stars);
  const canSpin = betAmount <= currentBalance && currentBalance > 0;

  // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º/—Å–∫—Ä—ã–≤–∞–µ–º –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ
  if (currentBalance === 0 || betAmount > currentBalance) {
    noBalanceWarning.style.display = 'block';
    spinBtn.disabled = true;
    spinBtn.style.background = 'linear-gradient(90deg, #666, #888)';
  } else {
    noBalanceWarning.style.display = 'none';
    spinBtn.disabled = isSpinning;
    spinBtn.style.background = 'linear-gradient(90deg, #ff6b6b, #ff8e53)';
  }

  // –û–±–Ω–æ–≤–ª—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –ø–æ–ª–∑—É–Ω–∫–æ–≤
  starsSlider.disabled = isSpinning;
  daysSlider.disabled = isSpinning;
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ Telegram
function initFromTelegram() {
  const initData = tg.initDataUnsafe;

  // –ü—Ä–æ–±—É–µ–º –ø–æ–ª—É—á–∏—Ç—å –±–∞–ª–∞–Ω—Å –∏–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∑–∞–ø—É—Å–∫–∞
  if (initData && initData.start_param) {
    try {
      const params = new URLSearchParams(initData.start_param);
      if (params.get('balance')) {
        currentBalance = parseInt(params.get('balance'));
      }
    } catch (e) {
      console.error('Error parsing start params:', e);
    }
  }

  // –ü—Ä–æ–±—É–µ–º –∏–∑ query string
  const urlParams = new URLSearchParams(window.location.search);
  const balanceFromUrl = urlParams.get('balance');
  if (balanceFromUrl) {
    currentBalance = parseInt(balanceFromUrl);
  }

  updateUI();
}

// –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è
topupBtn.addEventListener('click', () => {
  const isVisible = topupOptions.style.display !== 'none';
  if (isVisible) {
    topupOptions.style.display = 'none';
    topupBtn.innerHTML = '<i class="fas fa-coins"></i> –ü–û–ü–û–õ–ù–ò–¢–¨ –ë–ê–õ–ê–ù–°';
  } else {
    topupOptions.style.display = 'block';
    topupBtn.innerHTML = '<i class="fas fa-times"></i> –û–¢–ú–ï–ù–ê –ü–û–ü–û–õ–ù–ï–ù–ò–Ø';
  }
});

topupOptionElements.forEach(option => {
  option.addEventListener('click', () => {
    topupOptionElements.forEach(opt => {
      opt.classList.remove('selected');
      opt.querySelector('i').style.display = 'none';
    });

    option.classList.add('selected');
    option.querySelector('i').style.display = 'block';

    selectedTopupAmount = parseInt(option.dataset.amount);
    topupConfirmBtn.disabled = false;
    topupConfirmBtn.innerHTML = `<i class="fas fa-shopping-cart"></i> –ü–û–ü–û–õ–ù–ò–¢–¨ ${selectedTopupAmount} ‚≠ê`;
  });
});

topupConfirmBtn.addEventListener('click', () => {
  if (selectedTopupAmount >= 49) {
    const paymentData = {
      action: 'request_topup',
      amount: selectedTopupAmount,
      user_id: tg.initDataUnsafe?.user?.id,
      username: tg.initDataUnsafe?.user?.username,
      first_name: tg.initDataUnsafe?.user?.first_name,
      invoice_payload: `topup_${Date.now()}_${selectedTopupAmount}`
    };

    tg.sendData(JSON.stringify(paymentData));

    tg.showAlert(`–ó–∞–ø—Ä–æ—Å –Ω–∞ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ ${selectedTopupAmount} ‚≠ê –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω. –ë–æ—Ç –æ–±—Ä–∞–±–æ—Ç–∞–µ—Ç –≤–∞—à –∑–∞–ø—Ä–æ—Å –∏ –æ—Ç–∫—Ä–æ–µ—Ç –æ–∫–Ω–æ –æ–ø–ª–∞—Ç—ã.`);

    topupOptions.style.display = 'none';
    topupBtn.innerHTML = '<i class="fas fa-coins"></i> –ü–û–ü–û–õ–ù–ò–¢–¨ –ë–ê–õ–ê–ù–°';

    topupOptionElements.forEach(opt => {
      opt.classList.remove('selected');
      opt.querySelector('i').style.display = 'none';
    });
    selectedTopupAmount = 0;
    topupConfirmBtn.disabled = true;
    topupConfirmBtn.innerHTML = '<i class="fas fa-shopping-cart"></i> –í–´–ë–†–ê–¢–¨ –î–õ–Ø –ü–û–ü–û–õ–ù–ï–ù–ò–Ø';
  }
});

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞
function updateBalance(newBalance) {
  currentBalance = newBalance;
  updateUI();
}

starsSlider.addEventListener('input', updateUI);
daysSlider.addEventListener('input', updateUI);

spinBtn.addEventListener('click', () => {
  if (isSpinning) return;

  const betAmount = Number(starsSlider.value);
  if (betAmount > currentBalance) {
    tg.showAlert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∑–≤–µ–∑–¥ –Ω–∞ –±–∞–ª–∞–Ω—Å–µ! –ü–æ–ø–æ–ª–Ω–∏—Ç–µ –±–∞–ª–∞–Ω—Å.");
    return;
  }

  isSpinning = true;

  starsSlider.disabled = true;
  daysSlider.disabled = true;
  spinBtn.disabled = true;

  currentBalance -= betAmount;
  updateUI();

  resultDiv.textContent = '';
  resultDiv.className = 'result';

  const chance = calcChance() / 100;
  const win = Math.random() < chance;

  const extraSpins = 6 + Math.floor(Math.random() * 5);

  let finalAngle;
  if (win) {
    const winAngle = chance * 360;
    finalAngle = 360 * extraSpins + Math.random() * winAngle;
  } else {
    const winAngle = chance * 360;
    finalAngle = 360 * extraSpins + winAngle + Math.random() * (360 - winAngle);
  }

  const duration = 3500 + Math.random() * 1500;
  const startTime = Date.now();

  spinArrow.style.transition = 'none';
  spinArrow.style.transform = 'translateX(-50%) rotate(0deg)';

  function animate() {
    const elapsed = Date.now() - startTime;
    const progress = Math.min(elapsed / duration, 1);
    const easeOutCubic = 1 - Math.pow(1 - progress, 3);
    const currentAngle = easeOutCubic * finalAngle;

    spinArrow.style.transform = `translateX(-50%) rotate(${currentAngle}deg)`;

    if (progress < 1) {
      animationFrameId = requestAnimationFrame(animate);
    } else {
      animationFrameId = null;

      setTimeout(() => {
        const daysWon = Number(daysSlider.value);

        if (win) {
          resultDiv.textContent = `–£–°–ü–ï–•! –í—ã –≤—ã–∏–≥—Ä–∞–ª–∏ ${daysWon} –¥–Ω–µ–π –ü—Ä–µ–º–∏—É–º–∞! üéâ`;
          resultDiv.className = 'result win';

          const winData = {
            action: 'premium_won',
            stars_bet: betAmount,
            days_won: daysWon,
            chance_percent: (chance * 100).toFixed(1),
            user_id: tg.initDataUnsafe?.user?.id,
            username: tg.initDataUnsafe?.user?.username,
            first_name: tg.initDataUnsafe?.user?.first_name,
            timestamp: new Date().toISOString(),
            transaction_id: `win_${Date.now()}_${tg.initDataUnsafe?.user?.id || 'unknown'}`
          };

          tg.sendData(JSON.stringify(winData));

          tg.showAlert(`üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –í—ã –≤—ã–∏–≥—Ä–∞–ª–∏ ${daysWon} –¥–Ω–µ–π –ü—Ä–µ–º–∏—É–º–∞!`);
        } else {
          resultDiv.textContent = '–ù–µ –ø–æ–≤–µ–∑–ª–æ... –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑!';
          resultDiv.className = 'result lose';

          const loseData = {
            action: 'roulette_lose',
            stars_bet: betAmount,
            user_id: tg.initDataUnsafe?.user?.id,
            timestamp: new Date().toISOString()
          };

          tg.sendData(JSON.stringify(loseData));
        }

        spinArrow.style.transition = 'none';
        spinArrow.style.transform = 'translateX(-50%) rotate(0deg)';

        setTimeout(() => {
          isSpinning = false;
          updateUI();
        }, 500);

      }, 500);
    }
  }

  animate();
});

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
createCircleMarks();
initFromTelegram();

// –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞
window.updateBalance = updateBalance;

// –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥ –æ—Ç –±–æ—Ç–∞
window.addEventListener('message', (event) => {
  try {
    const data = JSON.parse(event.data);

    if (data.action === 'update_balance') {
      updateBalance(data.balance);
    } else if (data.action === 'topup_success') {
      tg.showAlert(`–ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –Ω–∞ ${data.amount} ‚≠ê —É—Å–ø–µ—à–Ω–æ! –ù–æ–≤—ã–π –±–∞–ª–∞–Ω—Å: ${data.new_balance} ‚≠ê`);
      updateBalance(data.new_balance);
    } else if (data.action === 'admin_balance_update') {
      // –ö–æ–º–∞–Ω–¥–∞ –æ—Ç –±–æ—Ç–∞ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞ (–¥–ª—è –∞–¥–º–∏–Ω–æ–≤)
      if (checkIfAdmin()) {
        currentBalance = data.new_balance;
        updateUI();
        tg.showAlert(`–ë–∞–ª–∞–Ω—Å –æ–±–Ω–æ–≤–ª–µ–Ω: ${data.new_balance} ‚≠ê`);
      }
    }
  } catch (e) {
    console.error('Error parsing message:', e);
  }
});

// –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∑–∞–∫—Ä—ã—Ç–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
tg.onEvent('closing', () => {
  console.log('Web App –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è');
});
</script>
</body>
</html>
